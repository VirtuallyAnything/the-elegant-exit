[gd_scene load_steps=23 format=3 uid="uid://dmyfdjltetw2d"]

[ext_resource type="Script" uid="uid://t6642lxnuqwn" path="res://src/SceneCode/MainScene.cs" id="1_klk3w"]
[ext_resource type="PackedScene" uid="uid://dmfp5lawyswyl" path="res://Scenes/PartyGroundFloor.tscn" id="2_i0j58"]
[ext_resource type="Script" uid="uid://lcb2jtbtmhll" path="res://src/Party/Player/PartyPlayer.cs" id="3_53yld"]
[ext_resource type="PackedScene" uid="uid://damjwt0d5a1y8" path="res://Scenes/PartyFirstFloor.tscn" id="3_c1ier"]
[ext_resource type="Resource" uid="uid://d0bu2gll3u4xb" path="res://GameDataResources/Attacks/PlayerData.tres" id="4_iwfah"]
[ext_resource type="Texture2D" uid="uid://k4q8rnj22dsh" path="res://Assets/Textures/MainCharacterIcon.png" id="4_mph3w"]
[ext_resource type="PackedScene" uid="uid://d21hljw8t080d" path="res://Scenes/Subscenes/SocialBattery.tscn" id="5_t55tw"]
[ext_resource type="Script" uid="uid://ckaup28vstgtq" path="res://src/Party/Player/PlayerMovement.cs" id="6_enc0b"]
[ext_resource type="Texture2D" uid="uid://ceb1ia7oecf7l" path="res://Assets/Textures/PlayerSightCone.png" id="6_k7ig0"]
[ext_resource type="FontFile" uid="uid://dnj361fu4us32" path="res://Assets/Fonts/Lobster-Regular.ttf" id="6_q8ytb"]
[ext_resource type="Script" uid="uid://cura5g1qnu50b" path="res://src/Party/Player/PlayerVision.cs" id="7_hx8n4"]
[ext_resource type="Theme" uid="uid://bpp0q38rfd1ms" path="res://Assets/Themes/Lobster.tres" id="7_yess5"]
[ext_resource type="Script" uid="uid://bfeb44fa5i8t6" path="res://src/GameTimer.cs" id="8_28aws"]
[ext_resource type="Texture2D" uid="uid://c6bque4e81yg4" path="res://Assets/UI/Icons/PauseIcon.png" id="8_mivmb"]
[ext_resource type="Texture2D" uid="uid://dw0fjgs4yx85r" path="res://Assets/UI/Icons/PauseIcon_hover.png" id="9_tqae0"]
[ext_resource type="PackedScene" uid="uid://bkprvu4f5y5no" path="res://Scenes/PauseScene.tscn" id="12_3yaqs"]
[ext_resource type="Script" uid="uid://de77385nrcieg" path="res://src/UI/OneTimeControl.cs" id="13_5qxwa"]
[ext_resource type="Texture2D" uid="uid://l6pgu7u0da8x" path="res://Assets/UI/Icons/Arrow_2.png" id="14_05esd"]
[ext_resource type="Script" uid="uid://dfn0w6pr1kxw2" path="res://src/GameManager.cs" id="15_xc4hf"]

[sub_resource type="CircleShape2D" id="CircleShape2D_rv6dr"]
radius = 14.6245

[sub_resource type="LabelSettings" id="LabelSettings_3w7eg"]
line_spacing = -35.0
font = ExtResource("6_q8ytb")
font_size = 110
font_color = Color(1, 0.8, 0.701961, 1)
shadow_size = 10
shadow_color = Color(0.12549, 0.0431373, 0.145098, 1)
shadow_offset = Vector2(8, 8)

[sub_resource type="LabelSettings" id="LabelSettings_jpcul"]
line_spacing = -35.0
font = ExtResource("6_q8ytb")
font_size = 75
font_color = Color(1, 0.8, 0.701961, 1)
shadow_size = 10
shadow_color = Color(0.12549, 0.0431373, 0.145098, 1)
shadow_offset = Vector2(8, 8)

[node name="MainScene" type="Control" node_paths=PackedStringArray("_encounterLayer", "_pauseLayer", "_socialBattery", "_camera")]
layout_mode = 3
anchors_preset = 0
mouse_filter = 1
script = ExtResource("1_klk3w")
_floorsPacked = Array[PackedScene]([ExtResource("2_i0j58"), ExtResource("3_c1ier")])
_encounterLayer = NodePath("EncounterLayer")
_pauseLayer = NodePath("PauseLayer")
_socialBattery = NodePath("Characters/Player/Camera2D/TextureProgressBar")
_camera = NodePath("Characters/Player/Camera2D")

[node name="Characters" type="CanvasLayer" parent="."]
follow_viewport_enabled = true

[node name="Player" type="CharacterBody2D" parent="Characters" node_paths=PackedStringArray("_vision") groups=["Player"]]
position = Vector2(6838, 1076)
script = ExtResource("3_53yld")
_data = ExtResource("4_iwfah")
_sightConeSegments = 10
_sightConeAngleDegrees = 120.0
_sightConeRadius = 800.0
_vision = NodePath("Vision")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Characters/Player" groups=["Player"]]
scale = Vector2(3.285, 3.285)
shape = SubResource("CircleShape2D_rv6dr")

[node name="Sprite2D" type="Sprite2D" parent="Characters/Player"]
position = Vector2(-2.38419e-07, -1.52588e-05)
scale = Vector2(1.5, 1.5)
texture = ExtResource("4_mph3w")

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Characters/Player"]
path_desired_distance = 21.25
target_desired_distance = 21.25
radius = 20.0
time_horizon_agents = 0.66
debug_enabled = true

[node name="Camera2D" type="Camera2D" parent="Characters/Player"]

[node name="TextureProgressBar" parent="Characters/Player/Camera2D" instance=ExtResource("5_t55tw")]
offset_left = -876.0
offset_top = -506.0
offset_right = -663.0
offset_bottom = -404.0
max_value = 100.0
value = 100.0
texture_progress_offset = Vector2(22.855, 23.94)
metadata/_edit_use_anchors_ = true

[node name="Movement" type="Node" parent="Characters/Player" node_paths=PackedStringArray("_navAgent", "_nodeToMove", "_nodeToRotate")]
script = ExtResource("6_enc0b")
_navAgent = NodePath("../NavigationAgent2D")
_nodeToMove = NodePath("..")
_nodeToRotate = NodePath("../Vision")

[node name="Vision" type="Area2D" parent="Characters/Player"]
script = ExtResource("7_hx8n4")

[node name="PointLight2D" type="PointLight2D" parent="Characters/Player/Vision" groups=["PlayerVision"]]
energy = 0.0
shadow_filter = 1
texture = ExtResource("6_k7ig0")

[node name="EncounterLayer" type="CanvasLayer" parent="."]
layer = 2

[node name="Timer" type="Timer" parent="." node_paths=PackedStringArray("_displayLabel")]
one_shot = true
script = ExtResource("8_28aws")
_displayLabel = NodePath("../PauseLayer/Countdown")

[node name="PauseLayer" type="CanvasLayer" parent="."]
layer = 3

[node name="PauseScene" parent="PauseLayer" instance=ExtResource("12_3yaqs")]
visible = false

[node name="PauseButton" type="TextureButton" parent="PauseLayer"]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -64.0
offset_bottom = 65.0
grow_horizontal = 0
texture_normal = ExtResource("8_mivmb")
texture_pressed = ExtResource("9_tqae0")
texture_hover = ExtResource("9_tqae0")

[node name="Countdown" type="Label" parent="PauseLayer"]
layout_direction = 2
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -138.5
offset_right = 138.5
offset_bottom = 180.0
grow_horizontal = 2
text = "0:00"
label_settings = SubResource("LabelSettings_3w7eg")
horizontal_alignment = 1

[node name="Label" type="Label" parent="PauseLayer/Countdown"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.451
anchor_right = 0.451
offset_left = -124.927
offset_top = 128.0
offset_right = 125.073
offset_bottom = 154.0
theme = ExtResource("7_yess5")
theme_type_variation = &"LabelShadow"
theme_override_font_sizes/font_size = 22
text = "Until Karaoke Time"
horizontal_alignment = 1

[node name="Panel" type="Panel" parent="PauseLayer"]
process_mode = 2
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -526.0
offset_top = -411.0
offset_right = 526.0
offset_bottom = 437.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("7_yess5")
script = ExtResource("13_5qxwa")

[node name="MarginContainer" type="MarginContainer" parent="PauseLayer/Panel"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("7_yess5")

[node name="VBoxContainer" type="VBoxContainer" parent="PauseLayer/Panel/MarginContainer"]
layout_mode = 2

[node name="Label" type="Label" parent="PauseLayer/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
theme = ExtResource("7_yess5")
text = "Welcome to The Elegant Exit!"
label_settings = SubResource("LabelSettings_jpcul")

[node name="RichTextLabel" type="RichTextLabel" parent="PauseLayer/Panel/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
theme = ExtResource("7_yess5")
theme_type_variation = &"RichTextDialogue"
text = "This game aims to simulate the feeling of being an introvert at a party.
As such, the combat (Conversations) may seem difficult at times or hard to escape.
This means it is working as intended.
Enjoy the game!

You play as Marc & Anthony, a gay couple, stranded at their friend Stacey’s birthday party. You’re almost on the cusp of leaving as you hear the announcement…
It’s Karaoke and every guest has to sing! Your slot is scheduled in 30 minutes!
That’s too much. You can’t be here when they drag you on stage and put you in the limelight!
You have to get out!
Point & Click your way through the Party. (Press E to use Doors).
Hopefully nobody stops you for a Conversation. You don’t have the time nor the Social Battery to be here any longer. You might lose some Social Standing on the way, but that is just a small prize to pay for salvation.
(Time pauses while pondering more extensive guides in the menu)
Achieve The Elegant Exit!"

[node name="StartButton" type="TextureButton" parent="PauseLayer/Panel"]
layout_mode = 0
offset_left = 907.0
offset_top = 707.0
offset_right = 1038.0
offset_bottom = 830.0
mouse_default_cursor_shape = 2
texture_normal = ExtResource("14_05esd")

[node name="GameManager" type="Node" parent="." node_paths=PackedStringArray("_gameTimer", "_player")]
script = ExtResource("15_xc4hf")
_gameTimer = NodePath("../Timer")
_player = NodePath("../Characters/Player")

[connection signal="pressed" from="PauseLayer/PauseButton" to="PauseLayer/PauseScene" method="OnPauseButtonPressed"]
[connection signal="pressed" from="PauseLayer/Panel/StartButton" to="PauseLayer/Panel" method="Close"]
